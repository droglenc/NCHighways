---
title: "Answer Key"
subtitle: "1-Sample t CE"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    fig_height: 3
    fig_width: 3.5
    self_contained: no
---

```{r echo=FALSE, eval=FALSE}
# Renders an appropriate HTML file for the webpage
setwd("C:/aaaWork/Web/GitHub/NCMTH107/resources/ce-keys/")
source("../../rhelpers/rhelpers.R")
modHTML("1_Sample_t")
```

```{r echo=FALSE, results='hide', message=FALSE}
library(NCStats)
source("../../rhelpers/knitr_setup.R")
library(captioner)
tbls <- captioner(prefix="Table")
tbls(name="Ozone","Results from the one-sample t-test for testing that the mean thickness of the ozone layer is different than 300 Dobson units.")
```

----

## P-Value Calculations and Decisions

<ol>
<li>Reject $H_{0}$ because p-value=`r formatC(distrib((79.5-75)/(11.7/sqrt(50)),df=49,lower.tail=FALSE,distrib="t"),format="f",digits=4)`<&alpha;.</li>
```{r echo=FALSE}
distrib((79.5-75)/(11.7/sqrt(50)),df=49,lower.tail=FALSE,distrib="t")
```

<li>Reject $H_{0}$ because p-value=`r formatC(2*distrib((11.2-14)/(6.1/sqrt(25)),df=24,distrib="t"),format="f",digits=4)`<&alpha;.</li>
```{r echo=FALSE}
distrib((11.2-14)/(6.1/sqrt(25)),df=24,distrib="t")
```

<li>Do Not Reject $H_{0}$ because p-value=`r formatC(distrib((858-880)/(92/sqrt(80)),df=79,distrib="t"),format="f",digits=4)`>&alpha;.</li>
```{r echo=FALSE}
distrib((858-880)/(92/sqrt(80)),df=79,distrib="t")
```

<li>Do Not Reject $H_{0}$ because p-value=`r formatC(2*distrib((1730-1500)/(790/sqrt(40)),df=39,lower.tail=FALSE,distrib="t"),format="f",digits=4)`>&alpha;.</li>
```{r echo=FALSE}
distrib((1730-1500)/(790/sqrt(40)),df=39,lower.tail=FALSE,distrib="t")
```
</ol>

----

## Confidence Interval Calculations

<ol>
<li>See below.</li>
<ol type="a">
<li>C=0.90</li>
<li>Lower bound</li>
```{r echo=FALSE, results='hide', fig.show='hide'}
tstar <- distrib(0.9,df=49,type="q",lower.tail=FALSE,distrib="t")
lcb <- 79.5+tstar*11.7/sqrt(50)
```
<li>t*=`r formatC(tstar,format="f",digits=3)`.</li>
```{r echo=FALSE}
distrib(0.9,df=49,type="q",lower.tail=FALSE,distrib="t")
```
<li>`r formatC(lcb,format="f",digits=1)`.</li>
<li>I am 90% confident that the true population mean is greater than `r formatC(lcb,format="f",digits=1)`.</li>
</ol>

<li>See below.</li>
<ol type="a">
<li>C=0.95</li>
<li>Interval</li>
```{r echo=FALSE, results='hide', fig.show='hide'}
tstar <- distrib(0.975,df=24,type="q",distrib="t")
ci <- 11.2+c(-1,1)*tstar*6.1/sqrt(25)
```
<li>t*=+/-`r formatC(tstar,format="f",digits=3)`.</li>
```{r echo=FALSE}
distrib(0.975,df=24,type="q",distrib="t")
```
<li>(`r formatC(ci[1],format="f",digits=1)`,`r formatC(ci[2],format="f",digits=1)`).</li>
<li>I am 95% confident that the true population mean is between `r formatC(ci[1],format="f",digits=1)` and `r formatC(ci[2],format="f",digits=1)`.</li>
</ol>

<li>See below.</li>
<ol type="a">
<li>C=0.99</li>
<li>Upper bound</li>
```{r echo=FALSE, results='hide', fig.show='hide'}
tstar <- distrib(0.99,df=79,type="q",distrib="t")
ucb <- 858+tstar*92/sqrt(80)
```
<li>t*=`r formatC(tstar,format="f",digits=3)`.</li>
```{r echo=FALSE}
distrib(0.99,df=79,type="q",distrib="t")
```
<li>`r formatC(lcb,format="f",digits=1)`.</li>
<li>I am 99% confident that the true population mean is less than `r formatC(ucb,format="f",digits=1)`.</li>
</ol>

<li>See below.</li>
<ol type="a">
<li>C=0.95</li>
<li>Interval</li>
```{r echo=FALSE, results='hide', fig.show='hide'}
tstar <- distrib(0.975,df=39,type="q",distrib="t")
ci <- 1730+c(-1,1)*tstar*790/sqrt(40)
```
<li>t*=+/-`r formatC(tstar,format="f",digits=3)`.</li>
```{r echo=FALSE}
distrib(0.975,df=39,type="q",distrib="t")
```
<li>(`r formatC(ci[1],format="f",digits=1)`,`r formatC(ci[2],format="f",digits=1)`).</li>
<li>I am 95% confident that the true population mean is between `r formatC(ci[1],format="f",digits=1)` and `r formatC(ci[2],format="f",digits=1)`.</li>
</ol>
</ol>

----

## Fecal Coliform Counts I



----

## Fecal Coliform Counts I



----

## Increased Civility
```{r KillingsCalc, echo=FALSE, results='hide', fig.show='hide'}
xbar <- 3292.8; sigma <- 4814.5; n <- 75
se <- sigma/sqrt(n)
t <- (xbar-4104)/se
df <- n-1
pv <- distrib(t,distrib="t",df=df)
ucb <- xbar+distrib(0.95,type="q",distrib="t",df=df)*se
```

<ol>
<li>&alpha;=0.05.</li>
<li>H<sub>A</sub>: &mu;<4104 and H<sub>0</sub>: &mu;=4104, where $\mu$ is the mean number of citizens killed by ALL nation-states.</li>
<li>1-sample t-test because (i) one population (all nation-states) was sampled, (ii) a quantitative variable (number of killings) was recorded, and (iii) &sigma; is not known.</li>
<li>An observational study with clear randomization of 75 countries.</li>
<li>The assumptions are met because (i) &sigma; is not known and (ii) n=75>40.</li>
<li>The sample mean ($\bar{x}$) is `r xbar` killings.</li>
<li>t=`r formatC(t,format="f",digits=4)` with `r df` df.</li>
<li>p-value=`r kPvalue(pv,include.p=FALSE,latex=FALSE)`.</li>
<li>Do not reject H<sub>0</sub> because the p-value>&alpha;.</li>
<li>It appears that the number of killings for recent times is NOT significanlty lower than it was as determined from 19th century history books.</li>
<li>Strictly not needed, but one could say that they were 95% confident that the number of killings in recent years for ALL nation-states is less than `r formatC(ucb,format="f",digits=0)` (which contains the value in the H<sub>0</sub>).</li>
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
<<KillingsCalc>>
```


----

## Thickness of the Ozone Layer

```{r OzoneCode, echo=FALSE, results='hide'}
ozo <- read.csv("https://github.com/droglenc/NCData/raw/master/OzoneSWI.csv")
( ozo.t <- t.test(ozo$Ozone,mu=300,conf.level=0.99) )
```

<ol>
<li>&alpha;=0.01</li>
<li>H<sub>0</sub>:&mu;=300, H<sub>A</sub>: &mu;&neq;300, where $\mu$ is the mean thickness of the ozone layer from ALL locations.</li>
<li>A one-sample t-test is required because (i) a quantitative variable (thickness) was measured, (ii)the individuals are from one population (the ozone layer over Arosa, SWI), and (iii) &sigma; is not known.  Thus, the population mean is being compared to a specific value in the null hypothesis.</li>
<li>An observational study of 45 random samples of ozone was conducted.</li>
<li>The assumptions are met because n=45>40 and &sigma; is UNknown.</li>
<li>The sample mean ($\bar{x}$) is `r formatC(ozo.t$estimate,format="f",digits=0)` (`r tbls("Ozone",display="cite")`).</li>

`r tbls("Ozone")`

```{r echo=FALSE}
kHtest(ozo.t)
```
<li>The test statistic is Z=`r formatC(ozo.t$statistic,format="f",digits=3)` with `r formatC(ozo.t$parameter,format="f",digits=0)` df (`r tbls("Ozone",display="cite")`).</li>
<li>The p-value `r kPvalue(ozo.t$p.value,include.p=FALSE,latex=FALSE)` (`r tbls("Ozone",display="cite")`).</li>
<li>The H<sub>0</sub> is rejected because the p-value<&alpha; (`r tbls("Ozone",display="cite")`).</li>
<li>The mean thickness of the ozone layer at ALL areas abova Arosa, SWI appears to be different (specifically greater) than 300 Dobson units.</li>
<li>I am 99\% confident that the mean thickness of the ozone layer in ALL areas above Arosa, SWI is between `r formatC(ozo.t$conf.int[1],format="f",digits=0)` and  `r formatC(ozo.t$conf.int[2],format="f",digits=0)` Dobson Units (`r tbls("Ozone",display="cite")`).</li>
</ol>

R Appendix
```{r eval=FALSE, prompt=FALSE}
<<OzoneCode>>
```

----
