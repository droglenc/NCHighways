---
title: "Review Exercise Key"
subtitle: "2-Sample t-Test"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    fig_height: 3
    fig_width: 3.5
    self_contained: no
---

```{r echo=FALSE, eval=FALSE}
# Renders an appropriate HTML file for the webpage
setwd("C:/aaaWork/Web/GitHub/NCMTH107/modules/zRevExAns/")
source("../../rhelpers/rhelpers.R")
modHTML("2Samplet")
```
```{r echo=FALSE, message=FALSE}
library(NCStats)
library(captioner)
tabs <- captioner(prefix="Table")
figs <- captioner(prefix="Figure")
```

----

## Popcorn Yield by Variety

1. $\alpha$ = 0.10.
1. The $H_{0}:\mu_{w}-\mu_{y}=0$ where $\mu$ is the mean number of unpopped kernels, $w$ represents white kernels, and $y$ represents yellow kernels (thus, positive numbers represent more unpopped white kernels). The $H_{A}:\mu_{w}-\mu_{y}\neq0$.
1. A two-sample t-test is required quantitative variable (kernels unpopped) was measured on two groups/populations (yellow and white) that were INdependent (there is no connection between any of the individuals of white corn and those of yellow corn) and two population means are being compared in the null hypothesis.
1. The data appear to be part of an observational study with the individuals randomly selected.
1. Individuals in the groups/populations are independent (there is no connection between any of the white and yellow kernels). The sample size ($n_{w}+n_{y}$=60) is $\geq$ 40. Therefore, the test statistic computed below should reasonably follow a t-distribution with $n_{w}+n_{y}-2$ = 58 df. The population variances appear to be equal because the p-value for Levene's test of the homogeneity of variance test (given as 0.972) is "large" (i.e., $>\alpha$).
1. The statistic is $\bar{x}_{w}-\bar{x}_{y}$ = 4.267-3.567 = 0.70. The pooled sample variance is $s_{p}^{2}=\frac{(30-1)4.456^{2}+(30-1)4.485^{2}}{30+30-2}$ = 19.99. The standard error of the statistic is $SE_{\bar{x}_{w}-\bar{x}_{y}}=\sqrt{19.99\left(\frac{1}{30}+\frac{1}{30} \right)}$ = 1.154.
1. The test statistic is t = $\frac{0.70-0}{1.154}$ = 0.606 with 58 df.
1. The p-value is `r kPvalue(2*pt(0.60,df=58,lower.tail=FALSE),include.p=FALSE)`.
1. The $H_{0}$ is not rejected because p-value $>\alpha$.
1. There does not appear to be a difference in the mean number of unpopped kernels between the white and yellow varieties.

### R Appendix
```{r eval=FALSE}
( pval <- 2*distrib(0.60,distrib="t",df=58,lower.tail=FALSE) )
```

----

## Heating System Efficiency

1. $\alpha$ = 0.10.
1. The $H_{0}:\mu_{e}-\mu_{t}=0$ where $\mu$ is the mean BTUs and the subscripts represent the two types of vents (positive numbers represent more BTUs used for houses fit with electric vent). The $H_{A}:\mu_{e}-\mu_{t}\neq0$.
1. A two-sample t-test is required because a quantitative variable (BTUs) was measured on two groups/populations (electric and thermal vents) that were INdependent (the two types of vents are not connected at all) and two population means are compared in the null hypothesis.
1. The data are part of an observational study where it is not obvious that the devices were randomly allocated to houses.
1. The individuals in the two groups are independent (no vent was placed in the same house). The sample size ($n_{e}+n_{t}$ = 90) is $\geq$ 40. Therefore, the test statistic computed below should reasonably follow a t-distribution with $n_{e}+n_{t}-2$ = 88 df. The population variances appear to be equal because the p-value for Levene's test of the homogeneity of variance test (given as 0.996) is "large" (i.e., $>\alpha$).
1. The statistic is $\bar{x}_{e}-\bar{x}_{t}$ = 9.908 $-$ 10.143 = -0.235. The pooled sample variance is $s_{p}^{2}=\frac{(40-1)3.020^{2}+(50-1)2.767^{2}}{40+50-2}$ = 8.305. The standard error of the statistic is $SE_{\bar{x}_{e}-\bar{x}_{t}}=\sqrt{8.305\left(\frac{1}{40}+\frac{1}{50} \right)}$ = 0.6113.
1. The test statistic is t = $\frac{-0.235-0}{0.6113}$ = 0.384 with 88 df.
1. The p-value is `r kPvalue(2*pt(0.384,df=88,lower.tail=FALSE),include.p=FALSE)`.
1. The $H_{0}$ is not rejected because the p-value $>\alpha$.
1. There does not appear to be a difference in average BTUs between houses equipped with the electrically and the thermally activated vent.

### R Appendix
```{r eval=FALSE}
( pval <- 2*distrib(0.384,distrib="t",df=88,lower.tail=FALSE) )
```

----

## Dioxins in Milk Cartons
```{r echo=FALSE, results="hide"}
mc <- read.csv("https://raw.githubusercontent.com/droglenc/NCData/master/MilkCartons.csv")
tabs(name="2tMilk","Results of 2-Sample t-Test for dioxin levels in lined and unlined milk cartons.")
```
```{r 2tMilk, echo=FALSE, results="hide"}
levenesTest(dioxin~type,data=mc)
( mc.t <- t.test(dioxin~type,data=mc,var.equal=TRUE,alt="less",conf.level=0.99) )
```

1. $\alpha$ = 0.01.
1. The $H_{0}:\mu_{L}-\mu_{UL}=0$ where $\mu$ is the mean dioxin level, $L$ represents lined, and $UL$ represents unlined cartons (thus, negative numbers represent lower dioxin levels in the lined cartons). The $H_{A}:\mu_{L}-\mu_{UL}<0$ (representing that the lined cartons will reduce the dioxin level).
1. A two-sample t-test is required because quantitative variable (dioxin level) was measured on two groups/populations (cartons with and without foil) that were INdependent (the lined and unlined cartons are not connected at all) and two population means are being compared in the null hypothesis.
1. The data appear to be part of an observational study; however there is no mention of randomization in this study although it would have been easy to randomly select cartons.
1. The individuals in the two groups are independent (cartons could not be both linead and unlined). The sample size ($n_{L}+n_{UL}$=`r nrow(mc)`) is $\geq$ 40. Therefore, the test statistic computed below should reasonably follow a t-distribution with $n_{L}+n_{UL}-2$ = `r nrow(mc) -2` df. The variances appear to be UNequal because the Levene's test p-value (`r kPvalue(levenesTest(dioxin~type,data=mc)[1,"Pr(>F)"],include.p=FALSE)`) is less than $\alpha$. Even though the assumptions are not fully met in this case, I am going to continue with the analysis.
1. The statistic is $\bar{x}_{L}-\bar{x}_{UL}$ = `r formatC(mc.t$estimate[1],format="f",digits=3)` - `r formatC(mc.t$estimate[2],format="f",digits=3)` = `r formatC(mc.t$estimate[1]-mc.t$estimate[2],format="f",digits=3)` (`r tabs("2tMilk",display="cite")`).
1. The test statistic is t = `r formatC(mc.t$statistic,format="f",digits=3)` with `r formatC(mc.t$parameter,format="f",digits=0)` df (`r tabs("2tMilk",display="cite")`).
1. The p-value is `r kPvalue(mc.t$p.value,include.p=FALSE)` (`r tabs("2tMilk",display="cite")`).
1. The $H_{0}$ is rejected because the p-value $<\alpha$.
1. The lined milk cartons have lower levels of dioxin, on average, than the unlined cartons.
1. A 99% upper confidence bound is `r formatC(mc.t$conf.int[2],format="f",digits=2)` (`r tabs("2tMilk",display="cite")`). One is 99% confident that the mean dioxin levels is more than `r formatC(-1*mc.t$conf.int[2],format="f",digits=2)` MORE in the unlined than in the lined cartons.

`r tabs("2tMilk")`

```{r echo=FALSE, background='white', comment=""}
kHtest(mc.t)
```

### R Appendix
```{r eval=FALSE}
mc <- read.csv("data/MilkCartons.csv")
<<2tMilk>>
@
```

----

## Low Grades in Math
```{r echo=FALSE, results="hide"}
mg <- read.csv("https://raw.githubusercontent.com/droglenc/NCData/master/UNCgrades.csv")
tabs(name="2tGrades","Results of 2-Sample t-Test for gpa in math and other classes at the University of North Carolina.")
```
```{r 2tMathGrades, echo=FALSE, results="hide"}
levenesTest(gpa~class.type,data=mg)
( mg.t <- t.test(gpa~class.type,data=mg,var.equal=TRUE,alt="less",conf.level=0.90) )
```

1. $\alpha$ = 0.10.
1. The $H_{0}:\mu_{m}-\mu_{o}=0$ where $\mu$ is the mean gpa, $m$ represents math class, and $o$ represents other classes (thus, negative numbers represent lower grades in math classes). The $H_{A}:\mu_{m}-\mu_{o}<0$ (representing that the mean gpa is lower in the math classes).
1. A two-sample t-test is required because a quantitative variable (gpa) was measured on two groups/populations (math class and other class) that were INdependent (the two types of classes are not connected at all) and two population means are being compared in the null hypothesis.
1. The data appear to be part of an observational study, probably without randomization as the students were not "forced" to take the certain classes.
1. The individuals in the two groups are independent (no classes consisted of all the same students). The sample size ($n_{m}+n_{o}$ = `r nrow(mg)`) is $\geq$ 40. Therefore, the test statistic computed below should reasonably follow a t-distribution with $n_{m}+n_{o}-2$ = `r nrow(mg)-2` df. The population variances appear to be equal because the Levene's test p-value (`r kPvalue(levenesTest(gpa~class.type,data=mg)[1,"Pr(>F)"],include.p=FALSE)`) is larger than $\alpha$.
1. The statistic is $\bar{x}_{m}-\bar{x}_{o}$ = `r formatC(mg.t$estimate[1],format="f",digits=3)` - `r formatC(mg.t$estimate[1],format="f",digits=3)` = `r formatC(mg.t$estimate[1]-mg.t$estimate[2],format="f",digits=3)` (`r tabs("2tMathGrades",display="cite")`).
1. The test statistic is t = `r formatC(mg.t$statistic,format="f",digits=3)` with `r formatC(mg.t$parameter,format="f",digits=0)` df (`r tabs("2tMathGrades",display="cite")`).
1. The p-value is `r kPvalue(mg.t$p.value,include.p=FALSE)` (`r tabs("2tMathGrades",display="cite")`).
1. The $H_{0}$ is rejected because the p-value $<\alpha$.
1. The mean gpa is lower in math classes than it is in the other classes.
1. A 90% upper confidence bound is `r formatC(mg.t$conf.int[2],format="f",digits=3)` (`r tabs("2tMathGrades",display="cite")`). Thus, one is 90% confident that the mean gpa of students in the math class is more than `r formatC(-1*mg.t$conf.int[2],format="f",digits=3)` LOWER than the gpa of students in the other classes.

`r tabs("2tGrades")`

```{r echo=FALSE, background='white', comment=""}
kHtest(mg.t)
```

### R Appendix
```{r eval=FALSE}
mg <- read.csv("data/UNCGrades.csv")
<<2tMathGrades>>
```

----

## Hours Worked by Medical Interns
```{r echo=FALSE, results="hide"}
med <- read.csv("https://raw.githubusercontent.com/droglenc/NCData/master/MedInternHrs.csv")
tabs(name="2tMedInterns","Results of 2-Sample t-Test for numbers of hours worked by medical interns in two cities.")
figs(name="2tMedInterns","Histogram of numbers of hours worked by medical interns in two cities.")
```
```{r 2tMedInterns, echo=FALSE, results="hide"}
levenesTest(hrs.worked~city,data=med)
( med.t <- t.test(hrs.worked~city,data=med,var.equal=TRUE,conf.level=0.90) )
```

1. $\alpha$ = 0.10.
1. The $H_{0}:\mu_{1}-\mu_{2}=0$ where $\mu$ is the mean number of hours worked, $1$ represents the first city, and $2$ represents the second city (thus, positive numbers represent a larger mean for the first city). The $H_{A}:\mu_{1}-\mu_{2}\neq0$.
1. A two-sample t-test is required because a quantitative variable (hours worked) was measured on two groups/populations (two cities) that were INdependent (there is no connection among individuals betwen the two cities) and two population means are being compared in the null hypothesis.
1. The data appear to be part of an observational study with the individuals randomly selected.
1. The individuals in the two groups are independent (all interns were not in both cities). The sample size ($n_{1}+n_{2}$=`r nrow(med)`) is $<$ 40 but $\geq$ 15. Histograms constructed for both groups (`r figs("2tMedInterns",display="cite")`) suggested a right-skewness but not an overly strong skew (this is very difficult to ascertain because of the small sample size). Therefore, the test statistic computed below should reasonably follow a t-distribution with $n_{1}+n_{2}-2$ = `r nrow(med)`-2 = `r nrow(med)-2` df. The population variances appear to be equal because the Levene's test p-value (`r kPvalue(levenesTest(hrs.worked~city,data=med)[1,"Pr(>F)"],include.p=FALSE)`) is larger than $\alpha$.
1. The statistic is $\bar{x}_{1}-\bar{x}_{2}$ = `r formatC(med.t$estimate[1],format="f",digits=2)` - `r formatC(med.t$estimate[1],format="f",digits=2)` = `r formatC(med.t$estimate[1]-med.t$estimate[2],format="f",digits=2)` (`r tabs("2tMedInterns",display="cite")`).
1. The test statistic is t =`r formatC(med.t$statistic,format="f",digits=3)` with `r formatC(med.t$parameter,format="f",digits=0)` df (`r tabs("2tMedInterns",display="cite")`).
1. The p-value is `r kPvalue(med.t$p.value,include.p=FALSE)` (`r tabs("2tMedInterns",display="cite")`).
1. The $H_{0}$ is rejected because the p-value $<\alpha$.
1. It appears that interns in the second city work more hours, on average, than interns in the first city.
1. A 90% confidence interval is from `r formatC(med.t$conf.int[1],format="f",digits=2)` to `r formatC(med.t$conf.int[2],format="f",digits=2)` (`r tabs("2tMedInterns",display="cite")`). Thus, one is 90% confident that the interns in the second city work between `r formatC(-1*med.t$conf.int[2],format="f",digits=2)` and `r formatC(-1*med.t$conf.int[1],format="f",digits=2)` hours more than interns in the first city.

```{r 2tMedInternsHist, echo=FALSE, fig.width=7}
hist(hrs.worked~city,data=med,xlab="Hours Worked")
```

`r figs("2tMedInterns")`

`r tabs("2tMedInterns")`

```{r echo=FALSE, background='white', comment=""}
kHtest(med.t)
```

### R Appendix
```{r eval=FALSE}
med <- read.csv("data/MedInternHrs.csv")
<<2tMedInterns>>
<<2tMedInternsHist>>  
```

----

## Corn Crop Yield
```{r echo=FALSE, results="hide"}
yld <- read.csv("https://raw.githubusercontent.com/droglenc/NCData/master/CropYield.csv")
tabs(name="2tYield","Results of 2-Sample t-Test for yields of corn between fields treated with an insecticide and sterile males.")
```
```{r 2tYield, echo=FALSE, results="hide"}
levenesTest(yield~group,data=yld)
( yld.t <- t.test(yield~group,data=yld,var.equal=TRUE,conf.level=0.90) )
```

1. $\alpha$ = 0.10.
1. The $H_{0}:\mu_{i}-\mu_{s}=0$ where $\mu$ represents the mean yield, $i$ represents the insecticide plots, and $s$ represents the sterile male plots (thus, positive numbers represent a larger yield in the insecticide treatments). The $H_{A}:\mu_{i}-\mu_{s}\neq0$.
1. A two-sample t-test is required because a quantitative variable (yield) was measured on two groups/populations (insecticide and sterile male plots) that were INdependent (there is no connection between plots that received the insecticide and those that received the sterile males) and two population means are being compared in the null hypothesis.
1. The data appear to be part of an experimental study with two treatments and 40 replicates. Plots were randomly allocated to treatments.
1. The individuals in the two groups are independent as there is no connection between the two types of plots. The sample size ($n_{i}+n_{s}$=`r nrow(yld)`) is $\geq$ 40. Therefore, the test statistic computed below should reasonably follow a t-distribution with $n_{i}+n_{s}-2$ = `r nrow(yld)`-2 = `r nrow(yld)-2` df. The variances appear to be equal because the Levene's test p-value (`r kPvalue(levenesTest(yield~group,data=yld)[1,"Pr(>F)"],include.p=FALSE)`) is larger than $\alpha$.
1. The statistic is $\bar{x}_{i}-\bar{x}_{s}$ = `r formatC(yld.t$estimate[1],format="f",digits=3)`-`r formatC(yld.t$estimate[1],format="f",digits=3)` = `r formatC(yld.t$estimate[1]-yld.t$estimate[2],format="f",digits=3)` (`r tabs("2tYield",display="cite")`).
1. The test statistic is t = `r formatC(yld.t$statistic,format="f",digits=3)` with `r formatC(yld.t$parameter,format="f",digits=0)` df (`r tabs("2tYield",display="cite")`).
1. The p-value is `r kPvalue(yld.t$p.value,include.p=FALSE)` (`r tabs("2tYield",display="cite")`).
 1. The $H_{0}$ is rejected because the p-value $<\alpha$.
1. It appears that yield is greater, on average, in the plots with the sterile males as compared to the plots with the insecticide.
1. A 90% confidence interval is `r formatC(yld.t$conf.int[1],format="f",digits=2)` to `r formatC(yld.t$conf.int[2],format="f",digits=2)` (`r tabs("2tYield",display="cite")`). Thus,one is 90% confident that the mean yield in plots with sterile males is between `r formatC(-1*yld.t$conf.int[2],format="f",digits=2)` and `r formatC(-1*yld.t$conf.int[1],format="f",digits=2)` bushels HIGHER than in plots with the insecticide.

`r tabs("2tYield")`

```{r echo=FALSE, background='white', comment=""}
kHtest(yld.t)
```

### R Appendix
```{r eval=FALSE}
yld <- read.csv("data/CropYield.csv")
<<2tYield>>
```

----

## Death Anxiety and Organ Donation
```{r echo=FALSE, results="hide"}
das <- read.csv("https://raw.githubusercontent.com/droglenc/NCData/master/DeathAnxiety.csv")
tabs(name="2tDAS","Results of 2-Sample t-Test for death anxiety score between organ and nonorgan donors.")
```
```{r 2tDAS, echo=FALSE, results="hide"}
das$donor1 <- factor(das$donor,levels=c("organ","non.organ"))
levenesTest(DAS~donor1,data=das)
( das.t <- t.test(DAS~donor1,data=das,var.equal=TRUE,conf.level=0.99) )
```

1. $\alpha$ = 0.01.
1. The $H_{0}:\mu_{o}-\mu_{n}=0$ where $\mu$ is the mean DAS, $o$ represents the organ donors, and $n$ represents the non-organ donors (thus, positive numbers represent a higher anxiety among organ donors). The $H_{A}:\mu_{o}-\mu_{n}\neq0$.
1. A two-sample t-test is required because a quantitative variable (DAS) was measured on two groups/populations (donor or not) that were INdependent and two population means are being compared in the null hypothesis.
1. The data appear to be part of an observational study where it is not clear if random samples were taken or not.
1. The individuals in the two groups are independent because the individual cannot both be a donor and a non donor. The sample size ($n_{o}+n_{n}$ = `r nrow(das)`) is $\geq$ 40. Therefore, the test statistic computed below should reasonably follow a t-distribution with $n_{o}+n_{n}-2$ = `r nrow(das)`-2 = `r nrow(das)-2` df. The variances appear to be equal because the Levene's test p-value (`r kPvalue(levenesTest(DAS~donor,data=das)[1,"Pr(>F)"],include.p=FALSE)`) is larger than $\alpha$.
1. The statistic is $\bar{x}_{o}-\bar{x}_{n}$ = `r formatC(das.t$estimate[1],format="f",digits=2)`-`r formatC(das.t$estimate[2],format="f",digits=2)` = `r formatC(das.t$estimate[1]-das.t$estimate[2],format="f",digits=2)` (`r tabs("2tDAS",display="cite")`).
1. The test statistic is t = `r formatC(das.t$statistic,format="f",digits=3)` with `r formatC(das.t$parameter,format="f",digits=0)` df (`r tabs("2tDAS",display="cite")`).
1. The p-value is `r kPvalue(das.t$p.value,include.p=FALSE)` (`r tabs("2tDAS",display="cite")`).
1. The $H_{0}$ is not rejected because the p-value $>\alpha$.
1. There does not appear to be a significant difference in average anxiety about death between organ donors and non-organ donors, at least at the 1% level.

`r tabs("2tDAS")`

```{r echo=FALSE, background='white', comment=""}
kHtest(das.t)
```

### R Appendix
```{r eval=FALSE}
das <- read.csv("dta/DeathAnxiety.csv")
<<2tDAS>>
```

----

## Pork Quality

1. $\alpha$ = 0.05.
1. The $H_{0}:\mu_{1}-\mu_{2}=0$ where $\mu$ is the mean backfat thickness and the subscripts represent the two diets (thus, positive numbers represent more backfat thickness for pigs fed diet 1). The $H_{A}:\mu_{1}-\mu_{2}\neq0$.
1. A two-sample t-test is required quantitative variable (backfat thickness) was measured on two groups/populations (different diets) that were INdependent and two population means are compared in the null hypothesis.
1. The data are part of an experimental study where the pigs were randomly allocated to treatments.
1. The individuals in the two groups are independent (no pig was fed both diets). The sample size ($n_{1}+n_{2}$=25) is $<$ 40 but $\geq$ 15 and the sample distributions (i.e., histograms) are not strongly skewed. Therefore, the test statistic computed below should reasonably follow a t-distribution with $n_{1}+n_{2}-2$ = 22 df. The population variances appear to be equal because the p-value for Levene's test of the homogeneity of variance test (given as 0.532) is "large" (i.e., $>\alpha$).
1. The statistic is $\bar{x}_{1}-\bar{x}_{2}$ = 3.420-2.989 = 0.431. The pooled sample variance is $s_{p}^{2}=\frac{(12-1)0.295^{2}+(12-1)0.375^{2}}{12+12-2}$ = $0.1138$. The standard error of the statistic is $SE_{\bar{x}_{1}-\bar{x}_{2}}=\sqrt{0.1138\left(\frac{1}{12}+\frac{1}{12} \right)}$ = 0.1377.
1. The test statistic is t = $\frac{0.431-0}{0.1377}$ = 3.13 with 22 df.
1. The p-value is `r kPvalue(2*pt(3.13,df=22,lower.tail=FALSE))`.
1. The $H_{0}$ is rejected because the p-value $<\alpha$.
1. There does appear to be a difference in average backfat thickness between pigs fed the two diets.
1. A 95% confidence interval is warranted in this situation with a $t^{*}$ of $\pm$ `r formatC(qt(0.025,df=22,lower.tail=FALSE),format="f",digits=3)`. Thus, 0.431 $\pm$ 2.074*0.1377, 0.431 $\pm$ 0.286, and (0.145,0.717). One is 95% confident that the difference in mean backfat thickness is between 0.145 and 0.717 cm. Thus, the mean backfat thickness on all pigs fed diet 1 is between 0.145 and 0.717 cm greater than the mean backfat thickness of all pigs fed diet 2. Thus, diet 2 produces higher quality pork.

### R Appendix
```{r eval=FALSE}
( pval <- 2*distrib(3.13,distrib="t",df=22,lower.tail=FALSE) )
( tstar <- distrib(0.025,distrib="t",type="q",df=22,lower.tail=FALSE) )
```
