---
title: "Answer Key"
subtitle: "Linear Regression CE"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    self_contained: false
---

```{r echo=FALSE, eval=FALSE}
## Renders an appropriate HTML file for the webpage
fnm <- "LinearRegression_CE_Keys"
setwd("C:/aaaWork/Web/GitHub/NCMTH107/modules/CE/Keys")
source("../../../rhelpers/rhelpers.R")
modHTML(fnm)
## And moves it to make it available to students
file.rename(from=paste0(fnm,".html"),to=paste0("../",fnm,".html"))
dir.create(paste0("../",fnm,"_files"),showWarnings=FALSE)
file.copy(from=paste0(fnm,"_files"),to=paste0("../"),recursive=TRUE)
```

```{r echo=FALSE, results='hide', message=FALSE}
library(NCStats)
source("../../../rhelpers/knitr_setup.R")
library(captioner)
figs <- captioner(prefix="Figure")
figs(name="IBI1","Fitted-line plot for the relatinoship between IBI scores and the percentage of imperious surface for 14 locations in Washington.")
figs(name="Cafe1","Fitted-line plot for the relatinoship between number of coffees sold and the maximum daily temperature for the college cafe.")

```

----

## Equation of the Line

1. **Dishwasher Example**
    1. response - Height of suds (mm)
    1. explanatory - Amount of soap (g)
    1. slope is 12.4
    1. intercept is -20.2
    1. For each additional gram of soap, the height of sudes increases by 12.4 mm, on average.
    1. For 0 grams of soap, the height of suds is -20.2 mm, on average.  [*This is an extrapolation.*]
    1. Ask to predict height of suds for an amount of soap between 3.5 and 8.0 grams.  Example ... "What is the predicted height of suds for 5 g of soap?"  Answer ... -20.2+12.4*5=41.8 mm.
    1. Ask to predict height of sudes for an amount of soap not between 3.5 and 8.0 grams.  Example ... "What is the predicted height of suds for 10 g of soap?"
1. **Livestock Food Example**
    1. response - Costs
    1. explanatory - Livestock food mix in pounds
    1. Slope is 190.
    1. Intercept is 12075
    1. For each additional ton of the food mix, the cost increases by $190, on average.
    1. For 0 tons of the food mix, the costs are $12075, on average. [*This may be considered as "start-up" costs.*]
    1. Ask to predict costs for food mix amounts between 36.5 and 42 tons.  Example ... "What is the cost to make 40 tons of the mix?"  Answer ... 190*40+12075 = $19675.
    1. Ask to predict costs for food mix amounts not between 36.5 and 42 tons.  Example ... "What is the cost to make 70 tons of the mix?"
1. **Grey Kangaroo Example**
    1. response - Nasal width (mm x10)
    1. explanatory - Nasal length (mm x10)
    1. The slope is 0.2876.
    1. The intercept is 46.451.
    1. For every 1 unit (10 mm) increase in nasal length, the nasal width increases by 0.2876 units (i.e., 2.876 mm), on average.
    1. The nasal width when the nasal length is 0 mm is 46.451 units (i.e., 464.51 mm), on average.
    1. Ask to predict the nasal width when the nasal length (x10) is between 450 and 900.  Example ... "What is the predicted nasal width when the nasal length (x10) is 600 (i.e., 60 mm)?"  Answer ... Y=0.2876*600+46.451=219.01 (or 21.9 mm).
    1. Ask to predict the nasal width when the nasal length (x10) is not between 450 and 900.  Example ... "What is the predicted nasal width when the nasal length (x10) is 250 (i.e., 25 mm)?"

----

## Beach Sand
```{r echo=FALSE}
m <- 0.053
b <- 0.159
rsq <- 0.912
```

1. The equation of the best-fit line is SAND = `r b`+`r m`*ANGLE
1. For each 1 degree increase in beach angle, the median sand diameter increases by `r m` mm, on average.
1. If there is 0 beach angle, then the median sand diameter is `r b` mm, on average.
1. This prediction should not be computed, because 15 degrees of beach angle is outside of the domain of the data used to define the relationship (i.e., this is an extrapolation).
1. The predicted median sand diameter for a beach angle of 4 degrees is `r formatC(b+m*4,format="f",digits=3)` mm.
1. The residual for an observed median sand diamter of 0.2 mm and beach angle of 5 degrees is `r formatC(0.2-(b+m*5),format="f",digits=3)` mm.
1. The correlation coefficient between median sand diameter and beach angle is `r formatC(sqrt(rsq),format="f",digits=3)`.
1. The proportion of variabiilty in median sand diameter that is explained by knowing the angle of the beach is `r formatC(rsq,format="f",digits=3)`.
1. I would expect the median sand diameter to increase by four slopes or `r formatC(4*m,format="f",digits=3)` mm, on average, if the beach angle increased by 4 degrees.
1. The relationship betwen median sand diameter and beach angle appears to be nonlinear.

----

## Urban Runoff

```{r echo=FALSE}
d <- data.frame(imp=c(60,43,43,34,27,25,21,18,11,8,8,8,7,7,5,4,2),
                IBI=c(9,11,13,23,31,31,21,23,27,37,39,29,31,43,33,35,37))
```
```{r IBICalc,echo=FALSE, results="hide"}
( lm1 <- lm(IBI~imp,data=d) )
rSquared(lm1)
```
```{r echo=FALSE}
cfs <- coef(lm1)
```

1. The equation of the best-fit line is IBI=`r formatC(cfs[1],format="f",digits=4)`-`r formatC(-cfs[2],format="f",digits=4)`*imp.
1. If the percent of impervious surface increases by 1%, then the IBI score decreases by `r formatC(-cfs[2],format="f",digits=2)`, on average.
1. If the percent of impervious surface is 0, then the IBI score is `r formatC(cfs[1],format="f",digits=1)`, on average.
1. This questions is an extrapolation and should not be answered.
1. The IBI score is predicted to be `r formatC(predict(lm1,data.frame(imp=20)),format="f",digits=1)` when the percent of impervious surface is 20%.
1. The residual for an observed IBI score of 20 and a percent of impervious surface of 30% is `r formatC(20-predict(lm1,data.frame(imp=30)),format="f",digits=1)`.
1. The IBI will change by -30 slopes or `r formatC(-30*cfs[2],format="f",digits=4)` if the percentage of impervious surface is decreased by 30%. In other words the IBI will increase by `r formatC(-30*cfs[2],format="f",digits=4)` units.
1. The correlation coefficient between IBI score and percent of impervious surface is `r formatC(-sqrt(rSquared(lm1)),format="f",digits=2)`.
1. The proportion of variability in IBI scores that is explained by knowing the percent of impervious surface is `r formatC(rSquared(lm1),format="f",digits=2)`.
1. There appears to be homoscedasticity, but there is slight evidence of a curve suggesting that the relationship is nonlinear (`r figs("IBI1",display="cite")`).

```{r IBIPlot,echo=FALSE,fig.width=3,fig.height=3,par1=TRUE}
fitPlot(lm1,xlab="Percentage of Impervious Surface")
```

`r figs("IBI1")`

R Appendix.
```{r eval=FALSE, prompt=FALSE}
d <- read.csv("runoff.csv")
<<IBICalc>>
<<IBIPlot>>
```

----

## Cafe Sales

```{r echo=FALSE}
d <- read.csv("cafedata.csv")
```
```{r CafeCalc,echo=FALSE,results="hide"}
( lm1 <- lm(coffee.sold~max.temp,data=d) )
rSquared(lm1)
```
```{r echo=FALSE}
cfs <- coef(lm1)
```

1. The equation of the best-fit line is COFFEESOLD = `r formatC(cfs[1],format="f",digits=4)`-`r formatC(-cfs[2],format="f",digits=4)`*MAXTEMP
1. For each additional degree of maximum temperature, the number of coffees sold decreases by `r formatC(-cfs[2],format="f",digits=2)`, on average.
1. If the maximum temperature is 0F, then the number of coffees sold is `r formatC(cfs[1],format="f",digits=1)`, on average.
1. The predicted number of coffees sold if the maximum temperature if 40F is `r formatC(predict(lm1,data.frame(max.temp=40)),format="f",digits=1)`.
1. This question is an extrapolation and should not be answered.
1. The residual for an observation of 30 coffees sold when the maximum temperature was 40F is `r formatC(30-predict(lm1,data.frame(max.temp=40)),format="f",digits=1)`.
1. The correlation coefficient between the number of coffees sold and the maximum temperature is `r formatC(-sqrt(rSquared(lm1)),format="f",digits=2)` (this should be interpreted cautiously as the relationship is slighly nonlinear; `r figs("Cafe1",display="cite")`).
1. The proportion of variability in number of coffees sold explained by knowing the maximum temperature is `r formatC(rSquared(lm1),format="f",digits=2)`.
1. The relationship appears to be homoscedastic, but nonlinear (`r figs("Cafe1",display="cite")`).

```{r CafePlot,echo=FALSE,fig.width=3,fig.height=3,par1=TRUE}
fitPlot(lm1,xlab="Maximum Temperature",ylab="Number of Coffees Sold")
```

`r figs("Cafe1")`

R Appendix.
```{r eval=FALSE, prompt=FALSE}
d <- read.csv("cafedata.csv")
<<CafeCalc>>
<<CafePlot>>
```

----
