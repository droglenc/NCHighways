---
title: "Answer Key"
subtitle: "Goodness-of-Fit CE"
author: Derek H. Ogle
layout: page
css: "/css/modules.css"
output:
  html_document:
    fig_height: 3
    fig_width: 3.5
    self_contained: no
---

```{r echo=FALSE, eval=FALSE}
# Renders an appropriate HTML file for the webpage
setwd("C:/aaaWork/Web/GitHub/NCMTH107/resources/ce-keys/")
source("../../rhelpers/rhelpers.R")
modHTML("GOFTest")
```

```{r echo=FALSE, results='hide', message=FALSE}
library(NCStats)
source("../../rhelpers/knitr_setup.R")
library(captioner)
tbls <- captioner(prefix="Table")

tbls(name="WaterExpTable","Expected frequency of students (assuming that Ho is true) by water type choice.")
tbls(name="WaterObsTable","Observed frequency of students by water type choice.")
tbls(name="WaterResults","Goodness-of-fit test results for testing that the distribution of students was the same among water type choices.")
tbls(name="WaterSum","Summary table of the proportion of students in each water type choice, with 95% confidence intervals and expected proportions from the goodness-of-fit test.")

tbls(name="TurkeyExpTable","Expected frequency of turkeys (assuming that Ho is true) by habitat in the spring.")
tbls(name="TurkeyObsTable","Observed frequency of turkeys by habitat in the spring.")
tbls(name="TurkeyResults","Goodness-of-fit test results for testing that the distribution of turkeys in the spring is the same as the disribution of available habitats.")
tbls(name="TurkeySum","Summary table of the proportion of turkeys in each habitat type, with 95% confidence intervals and expected proportions from the goodness-of-fit test.")

```

----

## Preference for Bottled Water?

```{r WaterCalc, echo=FALSE, results='hide', fig.show='hide', warning=FALSE}
w.obs <- c(tap=51,Aquafina=18,Fiji=17,Sams=21)
w.exp <- c(tap=1,Aquafina=1,Fiji=1,Sams=1)/4
w.chi <- chisq.test(w.obs,p=w.exp,rescale.p=TRUE,correct=FALSE)
w.chi
gofCI(w.chi,digits=3)
```

<ol>
<li>&alpha;=0.01.</li>
<li>H<sub>A</sub>: "There is a preference among the water choices (i.e., the distribution of students will NOT follow a theoretical distribution of equal proportions among the water choices)" and H<sub>O</sub>: "There is no preference among the water choices (i.e., the distribution of students will follow a theoretical distribution of equal proportions among the water choices)".</li>
<li>Goodness-of-fit test because (i) one population (students) were sampled and (ii) the response variable (water choice) is categorial.</li>
<li>This is quasi-experimental as the students were given a choice of only certain waters.  The students were not obviously randomly selected (and were likely part of a voluntary response survey).</li>
<li>All cells in the expected frequency table (`r tbls("WaterExpTable",display="cite")`) were greater than 5; the assumptions for a goodness-of-fit test have been met.</li>

`r tbls("WaterExpTable")`

```{r echo=FALSE}
w.chi$expected
```

<li>The observed frequency table is shown in `r tbls("WaterObsTable",display="cite")`.</li>

`r tbls("WaterObsTable")`

```{r echo=FALSE}
w.chi$observed
```

<li>&chi;<sup>2</sup>=`r formatC(w.chi$statistic,format="f",digits=4)` with `r w.chi$parameter` df (`r tbls("WaterResults",display="cite")`).</li>

`r tbls("WaterResults")`

```{r echo=FALSE}
w.chi
```

<li>p-value=`r kPvalue(w.chi$p.value,include.p=FALSE,latex=FALSE)` (`r tbls("WaterResults",display="cite")`).</li>
<li>Reject H<sub>0</sub> because the p-value&lt;&alpha;.</li>
<li>It appears that there is a preference for water type by the students.  Further analysis (`r tbls("WaterSum",display="cite")`) suggests that the students preferred the tap water.</li>

`r tbls("WaterSum")`

```{r echo=FALSE}
gofCI(w.chi,digits=3)
```

<li>From `r tbls("WaterSum",display="cite")`, one can conclude that between `r formatC(gofCI(w.chi)["tap","p.LCI"]*100,format="f",digits=1)` and  `r formatC(gofCI(w.chi)["tap","p.UCI"]*100,format="f",digits=1)`% of the students chose the tapwater.</li>
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
<<WaterCalc>>
```

----

## Habitat Use by Wild Turkeys

```{r TurkeyCalc, echo=FALSE, results='hide', fig.show='hide', warning=FALSE}
t.obs <- c(Aspen=61,Meadow=9,Pine=807,OakSpruce=1)
t.exp <- c(Aspen=0.0516,Meadow=0.1016,Pine=0.8371,OakSpruce=0.0100)
t.chi <- chisq.test(t.obs,p=t.exp,rescale.p=TRUE,correct=FALSE)
t.chi
gofCI(t.chi,digits=3)
```

<ol>
<li>&alpha;=0.05.</li>
<li>H<sub>A</sub>: "There is a preference by the turkeys for habitat (i.e., the distribution of turkeys will NOT follow the distribution of available habitats)" and H<sub>O</sub>: "There is NOT a preference by the turkeys for habitat (i.e., the distribution of turkeys will follow the distribution of available habitats)".</li>
<li>Goodness-of-fit test because (i) one population (South Dakota tukeys) were sampled and (ii) the response variable (habitat use) is categorial.</li>
<li>This is observational as habitat use by the turkeys was simply recorded.  The turkey observations were not randomly selected (the researchers likely chose days to sample).</li>
<li>All cells in the expected frequency table (`r tbls("TurkeyExpTable",display="cite")`) were greater than 5; the assumptions for a goodness-of-fit test have been met.</li>

`r tbls("TurkeyExpTable")`

```{r echo=FALSE}
t.chi$expected
```

<li>The observed frequency table is shown in `r tbls("TurkeyObsTable",display="cite")`.</li>

`r tbls("TurkeyObsTable")`

```{r echo=FALSE}
t.chi$observed
```

<li>&chi;<sup>2</sup>=`r formatC(t.chi$statistic,format="f",digits=4)` with `r t.chi$parameter` df (`r tbls("TurkeyResults",display="cite")`).</li>

`r tbls("TurkeyResults")`

```{r echo=FALSE}
t.chi
```

<li>p-value=`r kPvalue(t.chi$p.value,include.p=FALSE,latex=FALSE)` (`r tbls("TurkeyResults",display="cite")`).</li>
<li>Reject H<sub>0</sub> because the p-value&lt;&alpha;.</li>
<li>It appears that the turkeys show a habitat preference in the spring.  Further analysis (`r tbls("TurkeySum",display="cite")`) suggests that the turkeys showed a strong avoidance of meadows, a moderate avoidance of Oak/Spruce habitats, and a moderate preference for aspen and pine habitats.</li>

`r tbls("TurkeySum")`

```{r echo=FALSE}
gofCI(t.chi,digits=3)
```

<li>From `r tbls("TurkeySum",display="cite")`, one can conclude that between `r formatC(gofCI(t.chi)["Pine","p.LCI"]*100,format="f",digits=1)` and `r formatC(gofCI(t.chi)["Pine","p.UCI"]*100,format="f",digits=1)`% of the turkey observations were in the pine habitat.</li>
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
<<TurkeyCalc>>
```

----

## Random Jury Pool

```{r JuryCalc, echo=FALSE, results='hide', fig.show='hide', warning=FALSE}
j.obs <- c("18-19"=23,"20-24"=96,"25-29"=134,"30-39"=293,
           "40-49"=297,"50-64"=380,"65+"=113)
j.exp <- c("18-19"=6.1,"20-24"=15.0,"25-29"=13.5,"30-39"=21.7,
           "40-49"=15.3,"50-64"=18.2,"65+"=10.2)
j.chi <- chisq.test(j.obs,p=j.exp,rescale.p=TRUE,correct=FALSE)
j.chi
gofCI(j.chi,digits=3)
```

<ol>
<li>&alpha;=0.10.</li>
<li>H<sub>A</sub>: "The age distribution of the actual jury is not the same as the age distribution in the district as a whole" and H<sub>O</sub>: "The age distribution of the actual jury is the same as the age distribution in the district as a whole".</li>
<li>Goodness-of-fit test because (i) one population (the jury in this district) were sampled and (ii) the response variable (age category) is categorial.</li>
<li>This is observational as the jurors were not allocated to ages.  In theory the jury was randomly selected from the district, but that is what is being tested.</li>
<li>All cells in the expected frequency table (`r tbls("JuryExpTable",display="cite")`) were greater than 5; the assumptions for a goodness-of-fit test have been met.</li>

`r tbls("JuryExpTable")`

```{r echo=FALSE}
j.chi$expected
```

<li>The observed frequency table is shown in `r tbls("JuryObsTable",display="cite")`.</li>

`r tbls("JuryObsTable")`

```{r echo=FALSE}
j.chi$observed
```

<li>&chi;<sup>2</sup>=`r formatC(j.chi$statistic,format="f",digits=4)` with `r j.chi$parameter` df (`r tbls("JuryResults",display="cite")`).</li>

`r tbls("JuryResults")`

```{r echo=FALSE}
j.chi
```

<li>p-value=`r kPvalue(j.chi$p.value,include.p=FALSE,latex=FALSE)` (`r tbls("JuryResults",display="cite")`).</li>
<li>Reject H<sub>0</sub> because the p-value&lt;&alpha;.</li>
<li>It appears that the age distribution of the jury does not match the age distribution of the district as a whole.  Further analysis (`r tbls("JurySum",display="cite")`) suggests that the jury has a higher percentage of older jurors (ages "40-49" and "50-64") and a lower percentage of younger jurors (ages "18-19", "20-24", and "25-29") than expected as based on the age distribution in the district as a whole.</li>

`r tbls("JurySum")`

```{r echo=FALSE}
gofCI(j.chi,digits=3)
```

<li>From `r tbls("JurySum",display="cite")`, one can conclude, for example, that between `r formatC(gofCI(j.chi)["18-19","p.LCI"]*100,format="f",digits=1)` and `r formatC(gofCI(j.chi)["18-19","p.UCI"]*100,format="f",digits=1)`% of the jurors were between 18-19 years old.</li>
</ol>

R Appendix.
```{r eval=FALSE, prompt=FALSE}
<<JuryCalc>>
```
