<html>
<head><title>Northland College R FAQ</title></head>
<META http-equiv="Page-Enter" CONTENT="RevealTrans(Duration=1,Transition=3)">
<SCRIPT SRC="../../GNRL/scripts/GNRL.JS"></SCRIPT>
<body bgcolor="#FFFFB9">

<h1>What does the <font face="Courier New" color="#FF0000">chisq.test()</font> warning mean?</h1>
<p>Sometimes <font face="Courier New" color="#FF0000">chisq.test()</font> will return an error such as this ...</p>

<pre><font color="#0000FF">Warning message:
Chi-squared approximation may be incorrect in: chisq.test(...</font></pre>

<p>This warning is Rs way of telling you that you have not met the assumptions required for a chi-square test -- namely that the expected table does not have more than five individuals per cell.  You can confirm this by appending <font face="Courier New" color="#FF0000">$expected</font> to your chi-square test object.  For example, the following shows an expected table where all cells have values less than five (<i>note that this example is for a one-variable goodness-of-fit test but the concept is the same for a two-variable chi-square test</i>).</p>

<pre><font color="#FF0000">> library(NCStats)
> tan <- read.table("Tanner.txt",head=T)
> tan1 <- subset(tan,type=="slick.board" | type=="standard")
> tbl <- table(tan1$type)
> chi1 <- chisq.test(tbl,p=rep(1,4),rescale=TRUE,correct=FALSE)</font>
<font color="#0000FF">Warning message:
Chi-squared approximation may be incorrect in: chisq.test(tbl, p = rep(1, 4), rescale = TRUE, correct = FALSE)</font>
<font color="#FF0000">> chi1$expected</font>
<font color="#0000FF">   cod.sock slick.board    standard ZK.excluder 
        4.5         4.5         4.5         4.5</font></pre>

<p>This problem can be corrected in two ways.  First, you may collect a larger sample size.  Second, you may combine some categories so that the observed values are larger and, thus, the expected values are likely to be larger.</p>

<p>This problem is also likely to occur if the observed table contains unwanted levels, which is likely to happen if a data frame created with <font face="Courier New" color="#FF0000">subset()</font> is being used.  For example, the observed table for the chi-square test above is</p>

<pre><font color="#FF0000">> chi1$observed</font>
<font color="#0000FF">   cod.sock slick.board    standard ZK.excluder 
          0           9           9           0</font></pre>

<p>Thus, most of the problem in this example is that the observed table has two levels that are unwanted or unused.  This causes the expected values to be distributed across four rather than two categories.  This table can be corrected by using the <font face="Courier New" color="#FF0000">drop.levels()</font> function as described in <a href="freq_table_droplevels.html">this FAQ</a>.  The corrected chi-square looks like this ...</p>

<pre><font color="#FF0000">> tan1 <- drop.levels(tan1)
> tbl <- table(tan1$type)
> chi1 <- chisq.test(tbl,p=rep(1,2),rescale=TRUE,correct=FALSE)
> chi1$expected</font>
<font color="#0000FF">slick.board    standard 
          9           9</font>
<font color="#FF0000">> chi1$observed</font>
<font color="#0000FF">slick.board    standard 
          9           9</font></pre>

<p>The problem with unwanted levels is explained in more detail in <a href="subset_2groups.html">this FAQ</a>.</p>

<hr size="5" color="#800000">
<div align="center"><a href="FAQ_R_NC.html"><font size="+1">Return to FAQ List</font></a></div>

</body>
</html>
